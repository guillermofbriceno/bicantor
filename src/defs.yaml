- type: plain_def
  values:
      # Instruction Subsignal Encodings
    - "RS1_ENC": "19:15"
      "RS2_ENC": "24:20"
      "RD_ENC" : "11:07"
      "F7_ENC" : "31:25"
      "F3_ENC" : "14:12"
      "U_IMM_ENC(in)" : "{in[31:12], 12'b0}"
      "I_IMM_ENC(in)" : "{{22{in[31]}}, in[30:20]}"
      "S_IMM_ENC(in)" : "{{22{in[31]}}, in[31:25], in[11:7]}"
      "B_IMM_ENC(in)" : "{{20{in[31]}}, in[7], in[30:25], in[11:8], 1'b0}"
      "J_IMM_ENC(in)" : "{{12{in[31]}}, in[19:12], in[20], in[30:25], in[24:21], 1'b0}"

      # Helper Functions
      "CHAN(l,n)"     : "( (l * (n+1)) - 1 ) : ( l * n )"
      "TAG_RANGE(abits)" : "31:(31 - (29 - abits))"
      "IDX_RANGE(abits)" : "(31 - (29 - abits) - 1):2"

      # Branch Function Encodings
      "BEQ":  "3'b000"
      "BNE":  "3'b001"
      "BLT":  "3'b100"
      "BGE":  "3'b101"
      "BLTU": "3'b110"
      "BGEU": "3'b111"

      #                            #
      # Instruction Decoding Masks #
      #                            #

      # LUI Type
      "INST_LUI"   : "32'b???????_?????_?????_???_?????_0110111"
      # AUIPC Type
      "INST_AUIPC" : "32'b???????_?????_?????_???_?????_0010111"
      # JAL Type
      "INST_JAL"   : "32'b???????_?????_?????_???_?????_1101111"
      # JALR Type
      "INST_JALR"  : "32'b???????_?????_?????_000_?????_1100111"
      # BRANCH Type
      "INST_BEQ"   : "32'b???????_?????_?????_000_?????_1100011"
      "INST_BNE"   : "32'b???????_?????_?????_001_?????_1100011"
      "INST_BLT"   : "32'b???????_?????_?????_100_?????_1100011"
      "INST_BGE"   : "32'b???????_?????_?????_101_?????_1100011"
      "INST_BLTU"  : "32'b???????_?????_?????_110_?????_1100011"
      "INST_BGEU"  : "32'b???????_?????_?????_111_?????_1100011"
      # ALUI Type
      "INST_ADDI"  : "32'b???????_?????_?????_000_?????_0010011"
      "INST_SLTI"  : "32'b???????_?????_?????_010_?????_0010011"
      "INST_SLTIU" : "32'b???????_?????_?????_011_?????_0010011"
      "INST_XORI"  : "32'b???????_?????_?????_100_?????_0010011"
      "INST_ORI"   : "32'b???????_?????_?????_110_?????_0010011"
      "INST_ANDI"  : "32'b???????_?????_?????_111_?????_0010011"
      "INST_SLLI"  : "32'b0000000_?????_?????_001_?????_0010011"
      "INST_SRLI"  : "32'b0000000_?????_?????_101_?????_0010011"
      "INST_SRAI"  : "32'b0100000_?????_?????_101_?????_0010011"
      # ALUR Type
      "INST_ADD"   : "32'b0000000_?????_?????_000_?????_0110011"
      "INST_SUB"   : "32'b0100000_?????_?????_000_?????_0110011"
      "INST_SLL"   : "32'b0000000_?????_?????_001_?????_0110011"
      "INST_SLT"   : "32'b0000000_?????_?????_010_?????_0110011"
      "INST_SLTU"  : "32'b0000000_?????_?????_011_?????_0110011"
      "INST_XOR"   : "32'b0000000_?????_?????_100_?????_0110011"
      "INST_SRL"   : "32'b0000000_?????_?????_101_?????_0110011"
      "INST_SRA"   : "32'b0100000_?????_?????_101_?????_0110011"
      "INST_OR"    : "32'b0000000_?????_?????_110_?????_0110011"
      "INST_AND"   : "32'b0000000_?????_?????_111_?????_0110011"

- type: enum
  enum_name: "INST_ENUM"
  values:
    - "ENUM_LUI"
      # AUIPC Type
    - "ENUM_AUIPC"
      # JAL Type
    - "ENUM_JAL"
      # JALR Type
    - "ENUM_JALR"
      # BRANCH Type
    - "ENUM_BEQ"
    - "ENUM_BNE"
    - "ENUM_BLT"
    - "ENUM_BGE"
    - "ENUM_BLTU"
    - "ENUM_BGEU"
      # ALUI Type
    - "ENUM_ADDI"
    - "ENUM_SLTI"
    - "ENUM_SLTIU"
    - "ENUM_XORI"
    - "ENUM_ORI"
    - "ENUM_ANDI"
    - "ENUM_SLLI"
    - "ENUM_SRLI"
    - "ENUM_SRAI"
      # ALUR Type
    - "ENUM_ADD"
    - "ENUM_SUB"
    - "ENUM_SLL"
    - "ENUM_SLT"
    - "ENUM_SLTU"
    - "ENUM_XOR"
    - "ENUM_SRL"
    - "ENUM_SRA"
    - "ENUM_OR"
    - "ENUM_AND"

- type: mux
  mux_name: "PC_MUX"
  signals:
    - "PC_MUX_P8"
    - "TEMP5"
    - "TEMP6"

- type: enc_bus
  bus_name: "RVFI_BUS"
  values:
    - "RVFI_ORDER":     64
      "RVFI_INSN":      32
      "RVFI_PC_RDATA":  32
      "RVFI_PC_WDATA":  32
      "RVFI_RS1_ADDR":  5
      "RVFI_RS2_ADDR":  5
      "RVFI_RS1_DATA":  32
      "RVFI_RS2_DATA":  32

- type: mux
  mux_name: "BYPASS_MUX"
  signals:
    - "BYPASS_NONE"
    - "BYPASS_LSU0"
    - "BYPASS_LSU1"
    - "BYPASS_WB0"
    - "BYPASS_WB1"

- type: control_bus
  name: "CTRL_BUS"
  muxes:
    - mux_name: "ALU_SRC1_MUX"
      signals:
        - "U_IMM_SEL"
        - "RS1_SEL"

    - mux_name: "ALU_SRC2_MUX"
      signals:
        - "I_IMM_SEL"
        - "S_IMM_SEL"
        - "PC_SEL"
        - "RS2_SEL"

    - mux_name: "WB_MUX"
      signals:
        - "ALU_SEL"
        - "PC_P4_SEL"

  control_signals:
    - "RS1_ACTIVE"
    - "RS2_ACTIVE"
    - "REGWRITE"
    - "COND_BRANCH"
    - "ISSUE_PRI"
    - "ISSUE_SLOT"
    - "FUNCT7_SEL"
    - "FUNCT3_SEL"
    - "JAL"
    - "JALR"
    - "COND_BRANCH"
    - "ILLEGAL"
  
  operation_codes:
    "ALUI":
      - opcode:         "0010011"
        "REGWRITE":     1
        "RS1_ACTIVE":   1
        "FUNCT3_SEL":   1
        "ALU_SRC1_MUX": "RS1_SEL"
        "ALU_SRC2_MUX": "I_IMM_SEL"
        "WB_MUX":       "ALU_SEL"

    "ALUR":
      - opcode:         "0110011"
        "RS1_ACTIVE":   1
        "RS2_ACTIVE":   1
        "REGWRITE":     1
        "FUNCT3_SEL":   1
        "FUNCT7_SEL":   1
        "ALU_SRC1_MUX": "RS1_SEL"
        "ALU_SRC2_MUX": "RS2_SEL"
        "WB_MUX":       "ALU_SEL"

    "LUI":
      - opcode:         "0110111"
        "REGWRITE":     1
        "ALU_SRC1_MUX": "U_IMM_SEL"
        "ALU_SRC2_MUX": "RS2_SEL"
        "WB_MUX":       "ALU_SEL"

    "AUIPC":
      - opcode:         "0010111"
        "REGWRITE":     1
        "ALU_SRC1_MUX": "U_IMM_SEL"
        "ALU_SRC2_MUX": "PC_SEL"
        "WB_MUX":       "ALU_SEL"

    "JAL":
      - opcode:         "1101111"
        "REGWRITE":     1
        "JAL":          1
        "ISSUE_PRI":    1
        "ISSUE_SLOT":   0
        "WB_MUX":       "PC_P4_SEL"

    "JALR":
      - opcode:         "1100111"
        "REGWRITE":     1
        "JALR":         1
        "RS1_ACTIVE":   1
        "ALU_SRC1_MUX": "RS1_SEL"
        "ISSUE_PRI":    1
        "ISSUE_SLOT":   0
        "WB_MUX":       "PC_P4_SEL"

    "BRANCH":
      - opcode:         "1100011"
        "COND_BRANCH":  1
        "FUNCT3_SEL":   1
        "ALU_SRC1_MUX": "RS1_SEL"
        "ALU_SRC2_MUX": "RS2_SEL"
        "RS1_ACTIVE":   1
        "RS2_ACTIVE":   1
        "ISSUE_PRI":    1
        "ISSUE_SLOT":   0

    "ILLEGAL_INST":
      - opcode:         "XXXXXXX"
        "ILLEGAL":      1
